<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Ode to Music</title>
<script type=module>
import zim from "https://zimjs.com/cdn/015/zim_game";
const assets = [
// different player choices    
'glide.json','glide.png','nakomi.png', 'nakomi.json', 'nancy-idle.png', 'nancy-idle.json', 'nancy-run.png', 'nancy-run.json', 'nancy-jump.png', 'nancy-jump.json',
// different enemy choices
"shuriken.png", "start-btn.png",
// story slides
"1.png", "2.png", "3.png", "4.png", "5.png", "6.png", "7.png", "8.png", "9.png", "10.png",
// character sfx
"hurt.wav", "lets-go.wav", "game-over.wav", "note.mp3",
// tts
"a-long-time-ago.mp3", "the-ennui.mp3","sadness.mp3","rediscover.mp3", 
// ode to joy music plus parts
"otj-1.mp3", "otj-2.mp3", "otj-3.mp3", "otj-4.mp3", "ode-to-joy-complete.mp3",
// bg music
"cyberpunk-moonlight-sonata-beethoven.mp3",
"trailer-ode-to-joy.mp3"];

//~~~~~~~~~~~~~~~~~~ ZIM Frame Variables ~~~~~~~~~~~~~~~~~~
const path = "assets/";
const scaling = "fit";
const sWidth = 960;
const sHeight = 540;
const color = black;
const outerColor = darker;

new Frame(scaling, sWidth, sHeight, color, outerColor, ready, assets, path);
function ready() {    
    //const ground = new Rectangle(sWidth, 200, green).addTo();
    //ground.pos(0, sHeight - ground.height/2);
    function fadeIn(pagename, time){
        const blackRect = new Rectangle(sWidth, sHeight, black).addTo(pagename);
        blackRect.animate({alpha:0}, time);
        timeout(time, ()=>{
            blackRect.removeFrom();
        });
    }

    function fadeOut(pagename, time){
        const blackRect = new Rectangle(sWidth, sHeight, black).addTo(pagename);
        blackRect.alpha = 0;
        blackRect.animate({alpha:1}, time);
        timeout(time, ()=>{
            blackRect.removeFrom();
            pagename.removeFrom();
        });
    }
    const page0 = new Page();
    const page1 = new Page();
    const page2 = new Page();
    const page3 = new Page();
    const page4 = new Page();
    const page5 = new Page();
    const page6 = new Page();
    const page7 = new Page();
    const page8 = new Page();
    const page9 = new Page();
    const page10 = new Page();
    const picScale = 0.5;
    const pic1 = new Pic("1.png").sca(0.5)
    // .pos(0, 0, CENTER, CENTER)
    .addTo(page1);
    const pic2 = new Pic("2.png").sca(picScale)
    // .pos(0, 0, CENTER, CENTER)
    .addTo(page2);
    const pic3 = new Pic("3.png").sca(picScale)
    // .pos(0, 0, CENTER, CENTER)
    .addTo(page3);
    const pic4 = new Pic("4.png").sca(picScale)
    // .pos(0, 0, CENTER, CENTER)
    .addTo(page4);
    const pic5 = new Pic("5.png").sca(picScale)
    // .pos(0, 0, CENTER, CENTER)
    .addTo(page5);
    const startBtn = new Pic("start-btn.png").sca(0.16).pos(0, 0, CENTER, CENTER, page5).centerReg().cur();
    let playerScale = 0.25;
    const glenda = new Sprite({json:"nancy-idle.json"}).sca(playerScale).pos(100, 100, LEFT, BOTTOM, page5).run({loop:true});
    startBtn.on("mouseover", ()=>{
        const letsgo = new Aud("lets-go.wav", 0.5, false).play();
        startBtn.animate({props:{scale:0.18}, time: 0.7, loop: true, rewind: true});
    });
    startBtn.on("click", ()=>{
        location.href = "gather.html";
    });
    //page5.center();
    //~~~~~~~~~~~~~~~~~~~ Unused (used later)~~~~~~~~~~~~~~~~~~~
    // const pic6 = new Pic("6.png").sca(picScale)
    // // .pos(0, 0, CENTER, CENTER)
    // .addTo(page6);
    // const pic7 = new Pic("7.png").sca(picScale)
    // // .pos(0, 0, CENTER, CENTER)
    // .addTo(page7);
    // const pic8 = new Pic("8.png").sca(picScale)
    // // .pos(0, 0, CENTER, CENTER)
    // .addTo(page8);
    // const pic9 = new Pic("9.png").sca(picScale)
    // // .pos(0, 0, CENTER, CENTER)
    // .addTo(page9);
    // const pic10 = new Pic("10.png").sca(picScale)
    // // .pos(0, 0, CENTER, CENTER)
    // .addTo(page10);

    const page2Audio = new Aud("a-long-time-ago.mp3", 0.5, false); // 11 seconds
    const page3Audio = new Aud("the-ennui.mp3", 0.5, false); //6 seconds
    const page4Audio = new Aud("sadness.mp3", 0.5, false); //4 seconds
    const page5Audio = new Aud("rediscover.mp3", 0.5, false); //4 seconds

    function begin(){
        new Label({
            text:"Click to Begin",
            color:white,
            size: 50,
            font:"fantasy",
        }).centerReg().cur().on("click", ()=>{intro();});
    }
    begin();

    function intro(){
        page1.center();
        
        fadeIn(page1, 1);
        const bg = new Aud("trailer-ode-to-joy.mp3", 0.5, true).play();
        timeout(5, ()=>{
            fadeOut(page1,1.5);
            timeout(1.5, ()=>{
                page2.center();    
                fadeIn(page2, 1.5);
                page2Audio.play();
                timeout(12, ()=>{
                    fadeOut(page2,1.5);
                    //fadeIn(page3, 1.51);
                    page3.center();
                    page3Audio.play();
                    timeout(6, ()=>{
                        fadeOut(page3,1.5);
                        fadeIn(page4, 2);
                        page4.center();
                        page4Audio.play();
                        timeout(4, ()=>{
                            fadeOut(page4,1.5);
                            fadeIn(page5, 2);
                            page5.center();
                            page5Audio.play();
                        });
                    });
                });
            });
        });
    }
}
</script>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
</head>
<body></body>
</html>